<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Détail de l'annonce</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/AnnonceView.css">
</head>
<body>
    
    <div class="header">
        <span class="menu-icon" onclick="openNav()">&#9776;</span>
        <img src="../images/logo.png" alt="Co-Lock Logo" class="logo" onclick="window.location.href='index.php'">
        <div class="profile-icon" onclick="window.location.href='account.html'">&#128100;</div>
    </div>
    
    <div id="particles-js"></div>
    
    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a href="index.php">Accueil</a>
        <a href="EntrepriseListe.php">Voir les entreprises</a>
        <a href="Formulaire.html">Créer une annonce (Bureaux)</a>
        <a href="FormulaireEntreprise.html">Créer une annonce (Entreprise)</a>
        <a href="Contact.html">Contact</a>
    </div>

    <div class="container">
        <div class="card-detail" id="card-detail">
            <!-- Les détails de l'annonce seront insérés ici -->
        </div>
    </div>

    <footer>
        &copy; 2024 Co-Loc-k Bureaux. Tous droits réservés.
    </footer>

    <script>
        function openNav() {
            document.getElementById("mySidenav").style.width = "20%";
        }
    
        function closeNav() {
            document.getElementById("mySidenav").style.width = "0";
        }
    
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }
    
        async function loadAnnonceDetails() {
            const annonceId = getQueryParam('id'); // Récupère l'ID depuis l'URL
            console.log(`Annonce ID: ${annonceId}`); // Débogage : afficher l'ID de l'annonce
    
            try {
                const response = await fetch(`../scriptPhp/getAnnonceDetails.php?id=${annonceId}`);
                const annonce = await response.json();
    
                console.log(annonce); // Débogage : afficher les données reçues
    
                if (annonce.error) {
                    document.getElementById('card-detail').innerHTML = `<p>${annonce.error}</p>`;
                } else {
                    document.getElementById('card-detail').innerHTML = `
                        <div class="card-image">
                            <img src="../images/${annonce.image}" alt="${annonce.title}">
                        </div>
                        <div class="card-content">
                            <h1>${annonce.title}</h1>
                            <p class="description">${annonce.description}</p>
                            <div class="price-list">
                                <p><strong>Prix par heure : </strong>${annonce.price_hour} €</p>
                                <p><strong>Prix par jour : </strong>${annonce.price_day} €</p>
                                <p><strong>Prix par semaine : </strong>${annonce.price_week} €</p>
                            </div>
                            <p><strong>Ville : </strong>${annonce.city}</p>
                            <p><strong>Adresse : </strong>${annonce.address}</p>
                            <p><strong>Email du propriétaire : </strong><a href="mailto:${annonce.owner_email}">${annonce.owner_email}</a></p>
                            <button class="contact-owner">Contacter le propriétaire</button>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Erreur lors du chargement des détails de l\'annonce:', error);
            }
        }
    
        loadAnnonceDetails();
    </script>
    

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="../scriptJs/particles-config.js"></script>
</body>
</html>
